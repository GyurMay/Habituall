{"ast":null,"code":"import _regeneratorRuntime from\"/Users/gyurmeydorj/Habituall/client/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/Users/gyurmeydorj/Habituall/client/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/Users/gyurmeydorj/Habituall/client/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useAuth}from'../context/AuthContext.js';// import auth from '../services/auth.js';\nimport{useEffect,useState}from'react';import{useNavigate,useLocation}from'react-router-dom';// let error = false;\nimport\"../Login.css\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function LoginPage(props){var _location$state,_location$state$from;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),error=_useState2[0],setError=_useState2[1];var loggedOut=false;// const [motto, setMotto] = useState('');\n// useEffect(() => {\n//   if(!register){\n//     return <RegisterComp />;\n//   }\n// }, [register])\nvar navigate=useNavigate();var location=useLocation();var auth=useAuth();var from=((_location$state=location.state)===null||_location$state===void 0?void 0:(_location$state$from=_location$state.from)===null||_location$state$from===void 0?void 0:_location$state$from.pathname)||\"/\";if(auth.isAuthenticated)navigate(from);function handleSubmit(_x){return _handleSubmit.apply(this,arguments);}function _handleSubmit(){_handleSubmit=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var _ref3,username,password;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();_ref3=[document.querySelector('#username').value,document.querySelector('#password').value],username=_ref3[0],password=_ref3[1];// const [username, password] = [\"dorjee\",\"hi\"]\n// username = 'dorjee';\n// password ='hi';\n_context2.prev=2;_context2.next=5;return auth.authenticate(username,password);case 5:navigate(from);_context2.next=11;break;case 8:_context2.prev=8;_context2.t0=_context2[\"catch\"](2);// this.setState({ failed: true });\nsetError(true);case 11:;case 12:case\"end\":return _context2.stop();}},_callee2,null,[[2,8]]);}));return _handleSubmit.apply(this,arguments);}var registerUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(e){var _ref2,username,password,name,motto;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:e.preventDefault();_ref2=[document.querySelector('#r_username').value,document.querySelector('#r_password').value,document.querySelector('#r_name').value,document.querySelector('#r_motto').value],username=_ref2[0],password=_ref2[1],name=_ref2[2],motto=_ref2[3];if(!(username.trim()==''||password.trim()==''||name.trim()==''||motto.trim()=='')){_context.next=5;break;}alert('fill all the boxes');return _context.abrupt(\"return\");case 5:_context.prev=5;_context.next=8;return auth.register(username,password,name,motto);case 8:navigate(from);_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](5);// this.setState({ failed: true });\nsetError(true);case 14:;case 15:case\"end\":return _context.stop();}},_callee,null,[[5,11]]);}));return function registerUser(_x2){return _ref.apply(this,arguments);};}();function ErrorAlert(props){return/*#__PURE__*/_jsx(\"div\",{class:\"alert alert-danger\",style:{background:''},children:props.details});}var S_LoginComp=function S_LoginComp(props){return/*#__PURE__*/_jsxs(_Fragment,{children:[error&&/*#__PURE__*/_jsx(ErrorAlert,{details:\"Login failed\"}),loggedOut&&/*#__PURE__*/_jsx(ErrorAlert,{details:\"Log in to view page\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"login-area\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"banner\",children:\"Habituall \\uD83C\\uDF19 \\u2600\\uFE0F\"}),/*#__PURE__*/_jsxs(\"div\",{class:\"main\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",id:\"chk\",\"aria-hidden\":\"true\"}),/*#__PURE__*/_jsx(\"div\",{class:\"signup\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleSubmit,children:[/*#__PURE__*/_jsx(\"label\",{for:\"chk\",\"aria-hidden\":\"true\",children:\"Login\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"username\",name:\"username\",placeholder:\"Username\",required:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",name:\"password\",placeholder:\"Password\",required:\"\"}),/*#__PURE__*/_jsx(\"button\",{children:\"Login\"})]})}),/*#__PURE__*/_jsx(\"div\",{class:\"login\",children:/*#__PURE__*/_jsxs(\"form\",{onSubmit:registerUser,children:[/*#__PURE__*/_jsx(\"label\",{for:\"chk\",\"aria-hidden\":\"true\",children:\"Sign up\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"r_name\",name:\"name\",placeholder:\"Name\",required:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",id:\"r_username\",name:\"username\",placeholder:\"Username\",required:\"\"}),/*#__PURE__*/_jsx(\"input\",{type:\"motto\",id:\"r_motto\",name:\"motto\",placeholder:\"About your profile\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"r_password\",name:\"password\",placeholder:\"Enter your password\",required:\"\"}),/*#__PURE__*/_jsx(\"button\",{children:\"Sign up\"})]})})]})]})]});};return/*#__PURE__*/_jsx(S_LoginComp,{});};","map":{"version":3,"names":["useAuth","useEffect","useState","useNavigate","useLocation","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","LoginPage","props","_location$state","_location$state$from","_useState","_useState2","_slicedToArray","error","setError","loggedOut","navigate","location","auth","from","state","pathname","isAuthenticated","handleSubmit","_x","_handleSubmit","apply","arguments","_asyncToGenerator","_regeneratorRuntime","mark","_callee2","e","_ref3","username","password","wrap","_callee2$","_context2","prev","next","preventDefault","document","querySelector","value","authenticate","t0","stop","registerUser","_ref","_callee","_ref2","name","motto","_callee$","_context","trim","alert","abrupt","register","_x2","ErrorAlert","class","style","background","children","details","S_LoginComp","className","type","id","onSubmit","for","placeholder","required"],"sources":["/Users/gyurmeydorj/Habituall/client/src/pages/LoginPage.js"],"sourcesContent":["import { useAuth } from '../context/AuthContext.js';\r\n// import auth from '../services/auth.js';\r\nimport {useEffect, useState} from 'react';\r\nimport { useNavigate, useLocation } from 'react-router-dom';\r\n// let error = false;\r\nimport \"../Login.css\";\r\n\r\n\r\n\r\nexport default function LoginPage(props){\r\n  const [error, setError] = useState(false);\r\n  const loggedOut = false;\r\n  // const [motto, setMotto] = useState('');\r\n\r\n  // useEffect(() => {\r\n  //   if(!register){\r\n  //     return <RegisterComp />;\r\n  //   }\r\n  // }, [register])\r\n\r\n  const navigate = useNavigate();\r\n  const location = useLocation();\r\n  const auth = useAuth();\r\n  \r\n\r\n  const from = location.state?.from?.pathname || \"/\";\r\n  if(auth.isAuthenticated) navigate(from)\r\n  async function handleSubmit(e){\r\n    e.preventDefault();\r\n    const [username, password] = [document.querySelector('#username').value, document.querySelector('#password').value];\r\n    // const [username, password] = [\"dorjee\",\"hi\"]\r\n    // username = 'dorjee';\r\n    // password ='hi';\r\n    try{\r\n        await auth.authenticate(username, password);\r\n        navigate(from);\r\n    }catch(err) {\r\n        // this.setState({ failed: true });\r\n        setError(true);\r\n      };\r\n    \r\n  }\r\n  const registerUser = async (e) => {\r\n    e.preventDefault();\r\n    const [username, password, name, motto] = [document.querySelector('#r_username').value ,document.querySelector('#r_password').value, document.querySelector('#r_name').value, document.querySelector('#r_motto').value];\r\n    if(username.trim() == '' || password.trim() == '' || name.trim() == '' || motto.trim() == '')\r\n      {\r\n        alert('fill all the boxes');\r\n        return;\r\n      }\r\n    try{\r\n        await auth.register(username, password, name, motto);\r\n        navigate(from);\r\n    }catch(err) {\r\n        // this.setState({ failed: true });\r\n        setError(true);\r\n      };\r\n  };\r\n\r\n  function ErrorAlert(props){\r\n    return (\r\n      <div class='alert alert-danger' style={{background: ''}}>{props.details}</div>\r\n    )\r\n    }\r\n\r\n  const S_LoginComp = props => {\r\n\r\n    return (\r\n<>\r\n{error && <ErrorAlert details={\"Login failed\"} />}\r\n{loggedOut && <ErrorAlert details={\"Log in to view page\"} />}    \r\n\r\n<div className='login-area'>\r\n  <div className='banner'>Habituall üåô ‚òÄÔ∏è</div>\r\n\t<div class=\"main\">  \t\r\n  <input type=\"checkbox\" id=\"chk\" aria-hidden=\"true\" />\r\n    <div class=\"signup\">\r\n      <form onSubmit={handleSubmit}>\r\n      <label for=\"chk\" aria-hidden=\"true\">Login</label>\r\n        <input type=\"text\" id=\"username\" name=\"username\" placeholder=\"Username\" required=\"\" />\r\n        <input type=\"password\" id=\"password\" name=\"password\" placeholder=\"Password\" required=\"\" />\r\n        <button>Login</button>\r\n      </form>\r\n    </div>\r\n\r\n    <div class=\"login\">\r\n      \r\n      <form onSubmit={registerUser}>\r\n        <label for=\"chk\" aria-hidden=\"true\">Sign up</label>\r\n        <input type=\"text\" id=\"r_name\" name=\"name\" placeholder=\"Name\" required=\"\" />\r\n        <input type=\"text\" id=\"r_username\" name=\"username\" placeholder=\"Username\" required=\"\" />\r\n        <input type=\"motto\" id=\"r_motto\" name='motto' placeholder=\"About your profile\" />\r\n        <input type=\"password\" id=\"r_password\" name='password' placeholder=\"Enter your password\" required=\"\" />\r\n        <button>Sign up</button>\r\n      </form>\r\n    </div>\r\n  </div>\r\n</div>\r\n</>\r\n)\r\n  }\r\n\r\n  \r\n\r\n  return <S_LoginComp />\r\n};"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}